<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../styles.css">
  <title>File Upload</title>
</head>
<body>
    <div class="message"></div>
    <form id="file-upload-form">
      <input name="upFile" type="file">
      <input type="submit" value="add File">
    </form>

    <script>
      const myForm = document.querySelector('form');
      const myUpload = document.querySelector('input[name="upFile"]');
      const message = document.querySelector('.message'); // This line is the fix
      myForm.addEventListener('submit',(e)=>{
        e.preventDefault();
        message.textContent = 'Form Submitted';
        
        const file = myUpload.files[0]; // Correct way to access the file
        if (!file) {
          message.textContent = 'Please select a file.';
          return;
        }

        const fileR = new FileReader();
        fileR.onload = function(e) {
          const obj = {
            filename: file.name,
            mimeType: file.type,
            data: e.target.result // Get the result from the event object
          };
          
          google.script.run
            .withSuccessHandler(myResult)
            .adderFile(obj);
        };
        
        fileR.readAsDataURL(file); // Trigger the onload event
      });

      function myResult(val) {
        message.innerHTML = 'File uploaded successfully! ' + val;
      }
    </script>
</body>
</html>
